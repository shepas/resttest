# Тестовый RestApi

#Установка

1) установить зависимости из requiments.txt
2) для инициализации бд необходимо выполнить в терминале:
    python
    from database import init_db
    init_db
3) настроить celery + redis
4) запустить из терминала воркеры коммандой "celery worker -A main.celery -B --loglevel=info"
5) запустить сам сервис "python main.py"

#Описание функций

Формат (Адрес, метод, описание, пример запроса если требуется)

127.0.0.1:8080/, GET, получение списка стоек и серверов в них.

127.0.0.1:8080/server, GET, получение списка серверов.

127.0.0.1:8080/server/<id>, GET, получение информарции о сервере по ид.
    
127.0.0.1:8080/server, POST, создание сервера, в теле запроса пусто.

127.0.0.1:8080/server/<id>, DELETE, удаление сервера по ид.
    
127.0.0.1:8080/rack, GET, получение списка стоек.

127.0.0.1:8080/rack/<id>, GET, получение информации о стойке по ид.
    
127.0.0.1:8080/rack, POST, добавление стойки, {"size": 10}

127.0.0.1:8080/rack/<id>, DELETE, удаление стойки по ид.
    
127.0.0.1:8080/serveroperations, POST, добавление сервера в стойку, {"server_id": 1, "rack_id": 1}

127.0.0.1:8080/serveroperations, PUT, изменение статуса сервера, на оплачен {"server_id": 1, "status": "Paid", "expDate": 1513518058}, на удален {"server_id": 1, "status": "Deleted"}

127.0.0.1:8080/serveroperations/<id>, DELETE, удаление сервера из стойки

#Тестирование

тесты запускаются командой из консоли:
python tests.py

#Некоторые мысли

1) Сервер создается без статуса, так как он еще не находится в стойке и следовательно выключен.
2) Хотел заложить какие-нибудь иннер джоины но в текущей архитектуре не представилось возможности.
3) Знаю что статусы и размеры можно было сделать просто enum, но решил сделать отдельными справочниками потому как это хоть какой-то намек на масштабируемость
4) Асинхронные задачи хотел реализовать на Asyncio, но увы это не так было просто, помучавшись некоторое время использовал в итоге celery.
5) В тестах объял миннимальный функционал потому что в любом случае это куча кода похожего друг на друга.

PS
Понимаю что вышло несколько по индуски =)
